<h1 class="kb-article-title">Installing an SSL certificate on Nginx</h1> <p> <ul> <li><a href="#upl">Upload certificates</a></li> <li><a href="#cmbn">Combine the files</a></li> <li><a href="#vh">Configure VirtualHost file </a></li> <li><a href="#https">Configure HTTPS redirect</a></li> </ul> <div><br></div> <div>This article will guide you through the steps to install your SSL certificate on Nginx and to set up an automated redirect from HTTP:// to HTTPS://.<br></div> <ul></ul> <ol> <li> <h2 id="upl">Upload the certificates on the server where your website is hosted</h2> <p>Having completed the <a href="/support/knowledgebase/article.aspx/9446/14/generating-csr-on-apache--opensslmodsslnginx--heroku" linktext="CSR code generation" target="_blank">CSR code generation</a> and <a href="/support/knowledgebase/article.aspx/794/67/how-do-i-activate-an-ssl-certificate" linktext="SSL activation" target="_blank">SSL activation</a> steps, you will receive a zip file with the Sectigo (previously known as Comodo) Certificates via email. Alternatively, you can <a href="/support/knowledgebase/article.aspx/9464/14/can-i-download-an-issued-certificate-on-your-site" linktext="download them" target="_blank">download them</a> from your Namecheap Account panel.</p> <p><i><b>Note</b>: If you choose NGINX server when activating the certificate, you'll receive a zip file containing a Certificate file, with the '.crt' extension, and a Certificate Authority (CA) bundle file, with the '.ca-bundle' extension.</i></p> <p>Upload both files to your server whatever way you prefer. By using an FTP client, for example.</p> <p>You can also download the Bundle file for each Certificate by following the instructions <a href="/support/knowledgebase/article.aspx/9393/69/where-do-i-find-ssl-ca-bundle" linktext="here" target="_blank">here</a>.</p> </li><br><br><li> <h2 id="cmbn">Combine all the certificates into a single file</h2> <p>You need to have all the Certificates (<i>your_domain.crt</i> and <i>your_domain.ca-bundle</i>) combined in a single '.crt' file.</p> <p>The Certificate for your domain should come first in the file, followed by the chain of Certificates (CA Bundle).</p> <p>Enter the directory where you uploaded the certificate files. Run the following command to combine the files:</p> <p><i><b>$ cat your_domain.crt your_domain.ca-bundle &gt;&gt; your_domain_chain.crt<br><br><br></b></i></p> </li> <li> <h2 id="vh">Creating a separate Nginx VirtualHost file or Modifying the existing configuration file</h2> <p>To install the SSL certificate on Nginx, you  need to show the server which files to use, either by a) creating a new configuration file, or b) editing the existing one.</p> <p>    a) By  adding a new configuration file for the website you can  make 
sure that there are no issues with the separate configuration file. 
Furthermore, the whole server will not go down if there are any issues 
with the configuration file. 
						</p> <p>We suggest creating a new configuration file in this folder:</p> <p><b>/etc/nginx/conf.d</b></p> <p>That can be done via this command:</p> <p><i><b>sudo nano /etc/nginx/conf.d/Your_domain*-ssl.conf</b></i></p> <p><i>Where <b>Your_domain*-ssl.conf</b> is the name of the newly created file.</i></p>
						Next, copy and paste one of the below server blocks for the 443 port and edit the directories. Ensure the <i>server name</i> and <i>path to webroot match in both the server block for port 80 and the one for port 443</i>. If you have any other important values that need to be saved, move them to the newly created server block too.<p>    b) Edit the default configuration file of the web-server, which is named <b>nginx.conf</b>. It should be in one of these folders:</p> <p><b>/usr/local/nginx/conf</b></p><b></b><p><b>/etc/nginx</b></p><b></b><p><b>/usr/local/etc/nginx</b></p> <p>You can also use this command to find it:</p> <p><i><b>sudo find / -type f -iname "nginx.conf"</b></i></p> <p>Once you find it, open the file with:</p> <p><i><b>sudo nano nginx.conf</b></i></p> <p>Then copy and paste one of the server blocks for the 443 port given below and edit the directories <i>according to your server block for the 80 port (</i>with<i> matching </i><i>server name, </i><i>path to webroot,</i> and any<i> important values </i>you need).</p> <h3>Choose the server block:</h3> <p>Below you can find a server block for <i>your </i>Nginx version.</p> <p><i><b>Note</b>: To check your Nginx version, run this command:</i></p> <p><i><b>sudo nginx -v</b></i></p> <p><img class="kb-image" src="https://Namecheap.simplekb.com//SiteContents/2-7C22D5236A4543EB827F3BD8936E153E/media/nginx_inst_1.png"></p> <p><i><b>Note</b>: Replace the file names values, like <b>your_domain_chain.crt</b>,  in the server block with your details, and modify the routes to them using <b>/path/to/</b>.</i></p> <ul> <li>Server block for Nginx version 1.14 and below:</li> </ul> <p><i><b>server {</b></i></p><i><b></b><b></b></i><p><i><b>     listen 443;</b></i></p><i><b></b></i><p><i><b>     ssl on;</b></i></p><i><b></b><b></b></i><p><i><b>     ssl_certificate /path/to/certificate/your_domain_chain.crt;</b></i></p><i><b></b></i><p><i><b>     ssl_certificate_key /path/to/your_private.key;</b></i></p><i><b></b><b></b></i><p><i><b>     root /path/to/webroot;</b></i></p><i><b></b></i><p><i><b>     server_name your_domain.com;</b></i></p><i><b></b><b></b></i><p><i><b>}<br><br></b></i></p> <p><i><b>Note</b>: You can specify multiple hostnames in such configuration, if needed, e.g.:<br><br></i></p> <p><i><b>server {</b></i></p><i><b></b><b></b></i><p><i><b>     listen 443;</b></i></p><i><b></b></i><p><i><b>     ssl on;</b></i></p><i><b></b><b></b></i><p><i><b>     ssl_certificate /path/to/certificate/your_domain_chain.crt;</b></i></p><i><b></b></i><p><i><b>     ssl_certificate_key /path/to/your_private.key;</b></i></p><i><b></b><b></b></i><p><i><b>     root /path/to/webroot;</b></i></p><i><b></b></i><p><i><b>     server_name your_domain.com www.your_domain.com;</b></i></p><i><b></b><b></b></i><p><i><b>}<br><br></b></i></p> <ul> <li>Server block for Nginx version 1.15 and above:<br><br></li> </ul> <p><i><b>server {</b></i></p><i><b></b><b></b></i><p><i><b>     listen 443 ssl;</b></i></p><i><b></b><b></b></i><p><i><b>     ssl_certificate /path/to/certificate/your_domain_chain.crt;</b></i></p><i><b></b></i><p><i><b>     ssl_certificate_key /path/to/your_private.key;</b></i></p><i><b></b><b></b></i><p><i><b>     root /path/to/webroot;</b></i></p><i><b></b></i><p><i><b>     server_name your_domain.com;</b></i></p> <p><i><b>}<br><br></b></i></p> <ul> <li><i><b>ssl_certificate</b></i> should be pointed to the file with combined certificates you’ve <a href="#cmbn">created earlier</a>.</li> <li><i><b>ssl_certificate_key</b></i> should be pointed to the Private Key that was <a href="/support/knowledgebase/article.aspx/9446/0/apache-opensslmodsslnginx" linktext="generated with the CSR code" target="_blank">generated with the CSR code</a>.
<br><i>Here are <a href="/support/knowledgebase/article.aspx/9834/69/how-can-i-find-the-private-key-for-my-ssl-certificate#lnx" linktext="a few tips on how to find the Private key" target="_blank">a few tips on how to find the Private key</a> on Nginx.</i></li> </ul> <p><i><b><br>Important</b>: For either a <a href="/security/ssl-certificates/multi-domain.aspx" linktext="Multi-Domain" target="_blank">Multi-Domain</a> or a <a href="/security/ssl-certificates/wildcard.aspx" linktext="Wildcard Certificate" target="_blank">Wildcard Certificate</a>, you’ll need to have a separate server block added for each of the domain/subdomain included in the Certificate. Ensure you specify the domain/subdomain in question along with the paths to the same Certificate files in the VirtualHost record, as described above.</i></p> <p>Once the corresponding server block is added to the file, ensure you save the edits. Then, you can double-check the changes made with the following steps.</p> <p>Run this command to verify that the configuration file syntax is ok:</p> <p><i><b>sudo nginx -t</b></i></p> <p><img class="kb-image" src="https://Namecheap.simplekb.com//SiteContents/2-7C22D5236A4543EB827F3BD8936E153E/media/nginx_inst_2.png"></p> <p>If you receive errors, double check that you followed the guide properly. Feel free to contact our <a href="/support/" linktext="Support Team" target="_blank">Support Team</a> if you have any questions.</p> <p>If the server displays the test successfully, restart Nginx with this command to apply the changes:</p> <p><i><b>sudo nginx -s reload</b></i></p> <p>Now your SSL Certificate is installed. You can check the installation <a href="https://decoder.link/" linktext="here" target="_blank">here</a>.<br><br><br></p> </li> <li> <h2 id="https">Configure HTTPS redirect</h2> <p>We suggest that you install the redirect from HTTP to HTTPS. That way, your website visitors will only be able to access the secure version of your site.</p> <p>To do this, you’ll need to add one line to the configuration file with the server block for port 80.</p> <p><i><b>Tips:</b></i></p> <ul> <li><i>You can use one of the following commands to look up the configuration files which are enabled now:<br><br></i></li> </ul><i></i><p><b><i>sudo nginx -T | grep -iw "configuration file"</i></b></p><b><i></i></b><p><b><i>sudo nginx -T | grep -iw "include"</i></b></p><i></i><ul> <li><i>The default paths to the conf file are:<br><br></i></li> </ul><i></i><p><i>on RHEL-based Linux OS: <b>/etc/nginx/conf.d/default.conf</b></i></p><i></i><p><i>on Debian-based Linux OS: <b>/etc/nginx/sites-enabled/default</b></i></p><i></i><ul> <li><i>You can open the files to check which one contains the needed server block. For this, run:<br><br></i></li> </ul><i></i><p><b><i>sudo nano name_of_the_file</i></b></p> <p>Once you find the file that contains the server block for port 80 (the default HTTP port), add in the following line: </p> <p><b><i>return 301 https://$server_name$request_uri;</i></b></p><i></i><p><i><b>Note</b>: The above redirect rule should be entered as the last line in the server block.</i></p> <ul> <li><i><b>return</b></i> is the main directive to use.</li> <li><i><b>301</b></i> is permanent redirect (302 is the temporary one).</li> <li><i><b>https</b></i> is a specified scheme type (the explicit one instead of <i><b>$scheme </b></i>variable).</li> <li><i><b>$server_name</b></i> variable will use the domain specified in the server_name directive.</li> <li><i><b>$request_uri</b></i> variable is used to match the paths to the requested pages/parts of the website (everything after the domain name).<br><br></li> </ul> <p>Here are examples of server blocks with the HTTPS redirect:</p> <h3>Permanent redirect to HTTPS</h3> <p><i>server {</i></p><i></i><p><i> listen 80;</i></p><i></i><i></i><p><i> server_name your_domain.com www.your_domain.com;</i></p><i></i><p><i><b>return 301 https://$server_name$request_uri;</b></i></p><i></i><p><i>}</i></p> <h3>Permanent redirect to HTTPS non-www</h3> <p><i>server {</i></p><i></i><p><i>    listen 80;</i></p><i></i><i></i><p><i>    server_name your_domain.com www.your_domain.com;</i></p><i></i><p><i><b>return 301 https://your_domain.com$request_uri;</b></i></p><i></i><p><i>}</i></p> <h3>Permanent redirect to HTTPS www</h3> <p><i>server {</i></p><i></i><p><i>    listen 80;</i></p><i></i><i></i><p><i>    server_name your_domain.com www.your_domain.com;</i></p><i></i><p><i><b>return 301 https://www.your_domain.com$request_uri;</b></i></p><i></i><p><i>}</i></p> <h3>Temporary redirect to HTTPS non-www</h3> <p><i>server {</i></p><i></i><p><i>    listen 80;</i></p><i></i><i></i><p><i>    server_name your_domain.com www.your_domain.com;</i></p><i></i><p><i><b>return 302 https://your_domain.com$request_uri;</b></i></p><i></i><p><i>}</i></p> <p>You can find more details about redirect options on Nginx <a href="/support/knowledgebase/article.aspx/9805/38/setting-https-redirect-on-a-nginx-webserver" linktext="here" target="_blank">here</a>.</p> </li> </ol> </p></span></span><span id="ctl00_ctl00_ctl00_ctl00_base_content_web_base_content_home_content_page_content_left_RelatedArticleListDisplayControl1"><span>
